export const computeVulnerabilityDetails = (
    vulnerabilities,
    rAdjArray,
    k4,
    k5
  ) => {
    return vulnerabilities.map((v, index) => {
      const { subsystemIndex, impactScore, exploitScore, exploitExists } = v
      const vulSeverity = impactScore + exploitScore
      const iA = impactScore * rAdjArray[subsystemIndex]
      const cD = k4 * exploitScore + k5 * exploitExists
      const cA = 10 - exploitScore
      const prA = iA
  
      return {
        id: `V${index}`,
        subsystemIndex,
        vulSeverity,
        iA,
        cD,
        cA,
        prA,
        impactScore,
        exploitScore,
        exploitExists,
      }
    })
  }
  
  export const prioritizePatches = (vulDetails) => {
    return [...vulDetails].sort((a, b) => {
      const ratioA = a.iA / (a.cD + 0.01)
      const ratioB = b.iA / (b.cD + 0.01)
      return ratioB - ratioA
    })
  }
  